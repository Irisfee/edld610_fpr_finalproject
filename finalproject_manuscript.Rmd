---
title             : "Clickbait Title with SEO Keywords"
shorttitle        : "Clickbait Title"

author: 
  - name          : "Cameron S. Kay"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding author
    address       : "Department of Psychology, 1227 University of Oregon, Eugene, OR 97403"
    email         : "ckay@uoregon.edu"
  - name          : "Ashley L. Miller"
    affiliation   : "1"

affiliation:
  - id            : "1"
    institution   : "University of Oregon"

authornote: |
  Cameron Stuart Kay, Department of Psychology, University of Oregon; Ashley L. Miller, Department of Psychology, University of Oregon.

abstract: |
 Abstract goes herey
  
keywords          : "keywords"
wordcount         : "X"

bibliography      : ["r-references.bib"]

floatsintext      : no
figurelist        : no
tablelist         : no
footnotelist      : no
linenumbers       : no
mask              : no
draft             : no

header-includes:
  - \raggedbottom
  - \setlength{\parskip}{0pt}

documentclass     : "apa6"
classoption       : "man, fleqn, noextraspace"
output            : papaja::apa6_pdf
---

```{r setup, include = FALSE}
# load required packaages
library("papaja") # for creating the apa journal article
library(tidyverse) # for purrr, dplyr, and ggplot2 functions
library(rio) # for easy imporrting of data
library(here) # for reproducible paths
library(magrittr) # for the compound assigiment pipe-operator
library(lme4) # for conducting linear mixed-effects models
library(lmerTest) # for calculating t-tests for linear mixed-effects models

# import data as tibble and clean column names
data1 <- rio::import(here::here("data", "data_1.xlsx"), setclass = "tibble") %>%
  janitor::clean_names()

# turn off scientific notation
options(scipen = 999)
```

```{r clean_data1, include = FALSE}
# drop the display order columns
data1 %<>%
  select(-contains("do"))

# manuaally rename demographic columns
data1 %<>%
  rename(age          = q1_1,
         gender       = q1_2,
         gender_other = q1_2_5_text,
         race         = q1_4,
         race_other   = q1_4_10_text)


# create vectors of labels to use for renaming the columns
d3_traits    <- c("mach", "narc", "psyc")
   
sns          <- c("facebook", 
                  "pinterest", 
                  "instagram", 
                  "linkedin", 
                  "twitter", 
                  "snapchat", 
                  "youtube", 
                  "whatsapp", 
                  "reddit", 
                  "4chan", 
                  "tumblr")
 
int_motives  <- c("inform", 
                  "interp", 
                  "entert")
 
sns_addict   <- c("salience",
                  "tolerance",
                  "mood",
                  "relapse",
                  "withdraw",
                  "conflict")

sns_contexts <- c("society",
                  "self")

# create a function for detecting columns names from a string
col_match <- function(pattern, data) {
  
  # ensure pattern is a character and the data is a dataframe
  if (!is.character(pattern)) {
    stop("Pattern must be of type character.")
  } else if (!is.data.frame(data)) {
    stop("Data must of type dataframe/tibble.")
  }
  
  # return colnumn names that contain the pattern
  grepl(pattern, names(data))
}

# create function for creating names
name_creator <- function(scale_name, sub_name, scale_len, sub_len) {
  
  # calculate the subscale length if no subscale length provided
  if (missing(sub_len)) {
    sub_len <- scale_len / length(sub_name)
  }
  
  # create a vector of subscale names to match length of the scale
  if (length(sub_len) == 1) {
    sub_vector <- rep(sub_name, each = sub_len)
    
  } else {
    sub_vector <- rep(sub_name, times = sub_len)
  }

  # paste the values together
  scale_sub <- paste(scale_name, sub_vector, sep = "_")
  
  # if sub_len != 1, add item numbers
  if (any(sub_len != 1)) {
    # create a vector of item numbers
    item_nums <- rep(flatten_dbl(map(sub_len, seq_len)), times = scale_len / sum(sub_len))
    # combine scale_sub with the item_nums
    scale_sub <- paste(scale_sub, item_nums, sep = "_")
  }
  
  # return scale_sub
  scale_sub
  
}

flatten_dbl(map(c(8, 7, 5), seq_len))

flatten_dbl(map(8, seq_len))

name_creator("dd", d3_traits, 12)

name_creator("freq", sns, 11)

name_creator("len", sns, 11)

name_creator("sns_perc", sns_contexts, 2)

name_creator("int_mot", int_motives, 20, c(8, 7, 5))

name_creator("int_addict", sns_addict, 18)


names(data1)[col_match("q737", data1)] <- name_creator("dd", d3_traits, 12, 3)

names(data1)[grepl("q738", names(data1))] <- paste("freq", sns, seq_along(sns), sep = "_")

names(data1)[grepl("q7(5|6[0-3])", names(data1))] <- paste("len", sns, seq_along(sns), sep = "_")

names(data1)[grepl("q764", names(data1))] <- paste("sns_perception", c("society", "self"), sep = "_")

names(data1)[grepl("q765", names(data1))] <- paste("sns_perception", rep(int_motives, times = c(8, 7, 5)), flatten_dbl(map(c(8, 7, 5), seq_len)), sep = "_")

names(data1)[grepl("q766", names(data1))] <- paste("int_addiction", rep(sns_addiction, each = 3), rep(1:3, length(sns_addiction)), sep = "_")




```

Sagacious intro text goes here.

# Method

## Participants

## Material and procedure

## Data analysis

# Results

# Discussion

\newpage

# References
```{r create_r-references}
r_refs(file = "r-references.bib")
```

\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}

<div id = "refs"></div>
\endgroup
